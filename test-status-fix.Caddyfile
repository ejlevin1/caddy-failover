{
    order failover_proxy before reverse_proxy
    order failover_status before respond
    debug
}

:9090 {
    # Status endpoint
    handle /admin/failover/status {
        failover_status
    }

    # Test path 1: Should show as /auth/* not auto:...
    handle /auth/* {
        failover_proxy http://localhost:5051 https://httpbin.org/anything {
            fail_duration 3s
            status_path /auth/*
        }
    }

    # Test path 2: Should show as /admin/* not auto:...
    handle /admin/* {
        failover_proxy http://localhost:5041 http://localhost:5042 https://httpbin.org/anything {
            fail_duration 3s
            status_path /admin/*
        }
    }

    # Test path 3: Without status_path, should use handle path
    handle /api/* {
        failover_proxy http://localhost:5021 https://httpbin.org/anything {
            fail_duration 3s
        }
    }
}
